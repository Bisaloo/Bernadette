---
title: 'Bernadette: Bayesian Inference and Model Selection for Stochastic Epidemics in R'
tags:
  - Bayesian
  - Epidemics
  - R
  - Stan
authors:
  - name: Lampros Bouranis
    orcid: 0000-0002-1291-2192
    affiliation: 1
affiliations:
  - name: "Department of Statistics, Athens University of Economics and Business, Athens, Greece"
    index: 1
date: "`r Sys.Date()`"
bibliography: paper.bib
output:
  md_document:
    preserve_yaml: TRUE
    variant: "markdown_strict"
journal: JOSS
link-citations: yes
csl: apa.csl
---

# Summary

The Coronavirus Disease 2019 (COVID-19) outbreak caused by SARS-CoV-2 has led to developments in Bayesian infectious disease modeling, allowing modelers to assess the impact of mitigation strategies on transmission and to quantify the burden of the pandemic. 
The `Bernadette` package [@bernadette] for the open-source R statistical software [@rsoft] implements a Bayesian evidence synthesis approach to modeling the age-specific transmission dynamics of a disease based on daily mortality counts. 
The functionality of `Bernadette` can be used to reconstruct the epidemic drivers from publicly available data, to estimate key epidemiological quantities like the rate of disease transmission, the latent counts of infections and the reproduction number for a given population over time, and to perform model checking and model comparison using information criteria.
 
# Statement of need

The modeling of disease transmission dynamics is an active research area; a list of R packages dedicated to the analysis of epidemics is presented in the R Epidemics Consortium website (https://www.repidemicsconsortium.org/). 
Among these packages, `EpiEstim` [@Cori2013; @epiestim] offers a data-driven Bayesian framework for the reconstruction of the time-varying reproduction number of a disease, $R_t$, which represents the number of secondary infections generated by a case infected at day $t$. `EpiEstim` uses areal time-series in the form of case counts for a given period and population. 
The incidence of infection is assumed to follow a Poisson process with expectation given by a renewal equation.
The `epidemia` package [@epidemia] links observed areal data to latent infections, which are in turn modeled as a self-exciting process tempered by time-varying reproduction numbers. 
It also supports Bayesian multilevel models by pooling information across multiple populations.

`Bernadette` complements these packages by implementing the Bayesian hierarchical modeling approach described in @bouranis. It links the observed age-stratified mortality counts for a given population over time to latent infections via an over-dispersed count model.
The change in infections over time is governed by a deterministic multi-type compartmental model which is driven by potentially non-scalar diffusion processes to adequately capture the temporal evolution of the age-stratified transmission rates. 
`Bernadette` relaxes the assumption of a homogeneous population, incorporates age structure and accounts for the presence of social structures via publicly available contact matrices. 
This allows for further evidence synthesis utilizing information from contact surveys and for sharing statistical strength across age groups.
Further, the Bayesian evidence synthesis approach implemented in the `Bernadette` package enables learning the age-stratified virus transmission rates from one group to another, with a particular focus on the transmission rate between and onto vulnerable groups which could support public health authorities in devising interventions targeting these groups.
The effective reproduction number, $R_t$, is estimated from the daily age-stratified mortality counts, accounting for variations in transmissibility that are not obvious from reported infection counts. While estimation of the uncertainty over $R_t$ is itself a challenging problem [@gostic], it is propagated naturally via Markov chain Monte Carlo [@brooks].

# Functionality

<!-- See https://imperialcollegelondon.github.io/epidemia/articles/model-introduction.html -->

<!-- - Bayesian evidence synthesis -->
<!-- Generative model + figure. Connect this to the main functions -->
<!-- - Description of main functions -->
<!-- - Stan -->
<!-- - Information criteria with loo. -->

<!-- The probabilistic programming language `Stan` [@carpenter2017stan] has been used extensively to specify and fit Bayesian models for disease transmission during the Covid-19 pandemic.  -->
<!-- Examples analyses include Flaxman et al. (2020), Hauser et al. (2020) and Doremalen et al. (2020).  -->

`Bernadette` features nine functions for data processing and visualization, a main function for specifying and fitting the Bayesian hierarchical model and five functions for post-processing and visualization of posterior model estimates of important epidemiological quantities. The key model components are presented in Figure \@ref{fig:functional_relationships}. 
The Github page for this package contains a detailed [README](https://github.com/bernadette-eu/Bernadette/blob/master/README.md) file with a description of the modeling framework and the steps involved in the workflow.

```{r, fig.cap = "Functional relationships between data sources (rectangles), modeled outputs (ovals) and parameters (hexagons)", label = "functional_relationships"}
knitr::include_graphics("C:/Users/lbour/OneDrive/Desktop1/Files_HP_Lampros/Academic/Post_Doctoral_Researcher/1_Marie_Curie_PostDoc/8_BERNADETTE/8_Package/bernadette/paper/Data_generating_mechanism_eps.eps")
```

`Bernadette` uses the framework offered by `Stan` to both specify and fit models.
User-specified models are internally translated into data that is passed to a precompiled Stan program. The models are fit using sampling methods from `rstan` [@rstan].

The primary function is `stan_igbm()`

# Licensing and Availability

The `Bernadette` package is licensed under the GNU General Public License (GPL v3.0). It is available on CRAN, and can be installed using `install.packages("Bernadette")`. All code is open-source and hosted on GitHub, and bugs can be reported at https://github.com/bernadette-eu/Bernadette/issues/.

# Acknowledgements

Lampros Bouranis’ research is supported by the European Union’s Horizon 2020 research and innovation programme under the Marie Sklodowska-Curie grant agreement No 101027218.

# References
